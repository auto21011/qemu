name: Build_QEMU_WINDOWS_CI_CD
run-name: ${{ github.actor }} is building QEMU_CI_CD for linux using GitHub Actions ðŸš€
on:
  workflow_dispatch:
jobs:
  Build_Qemu_AARCH64_Win:
    runs-on: windows-latest
    defaults:
      run:
        shell: msys2 {0}
    steps:
      - uses: msys2/setup-msys2@v2
        with:
          msystem: MINGW64
          update: true
          install: >-
            curl
            git
            base
            base-devel
      - name: Check out repository code
        uses: actions/checkout@v4
      - name: Install build deps
        run: |
          curl -O https://raw.githubusercontent.com/msys2/MINGW-packages/refs/heads/master/mingw-w64-qemu/PKGBUILD
          sed -i '/^source=(/,/^)/ { /^source=(/b; /^)/b; s/^/#/ }' PKGBUILD
          sed -i '/^sha256sums=(/,/^)/ { /^sha256sums=(/b; /^)/b; s/^/#/ }' PKGBUILD
          makepkg --syncdeps --nobuild --noprepare --noconfirm PKGBUILD
      - name: configure
        run : |
          mkdir /opt/qemu_custom -p
          mkdir build
          cd build
          ../configure --target-list=aarch64-softmmu \
            --enable-sdl --enable-gtk \
            --disable-werror \
            --prefix=/opt/qemu_custom
      - name: build
        run: |
          cd build
          ninja -j8
      - name: build
        run: |
          cd build
          make install
      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          namr: artifact
          path: d:/a/_temp/msys64/opt/qemu_custom
      - run: echo "This job's status is ${{ job.status }}."

